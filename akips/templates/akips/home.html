{% extends 'akips/base.html' %}
{% load static %}

{% block title %}OCNES Dashboard{% endblock %}
{% block extra_head%}
<meta http-equiv="refresh" content="30">
{% endblock %}

{% block content %}
{% if critical %}
<div class="card">
    <div class="card-body table-responsive p-0">
        <table class="table table-hover table-sm">
            <thead>
                <tr>
                    <th>Ack</th>
                    <th>Critical Device</th>
                    <th>IP Address</th>
                    <th>Description</th>
                    <th>Last Event</th>
                    <th>Incident Request</th>
                </tr>
            </thead>
            <tbody>
                {% for crit in critical %}
                <tr>
                    <td>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="ack_crit_{{ crit.id }}">
                        </div>
                    </td>
                    <td><a href="{% url 'device' crit.name %}">{{ crit.name }}</a></td>
                    <td>{{ crit.device.ip4addr }}</td>
                    <td>{{ crit.device.sysDescr }}</td>
                    <td>{{ crit.last_event }}</td>
                    <td>{{ crit.incident }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endif %}

<div class="card">
    <div class="card-body table-responsive p-0">
        <table class="table table-hover table-sm">
            <thead>
                <tr>
                    <th>Ack</th>
                    <th>Distribution Tier</th>
                    <th>Switch Count</th>
                    <th>AP Count</th>
                    <th>UPS Count</th>
                    <th>Percent Down</th>
                    <th>Last Event</th>
                    <th>Trend</th>
                    <th>Incident Request</th>
                </tr>
            </thead>
            <tbody>
                {% for tier in tiers %}
                <tr>
                    <td>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="ack_tier_{{ tier.id }}">
                        </div>
                    </td>
                    <td><a href="{% url 'tier' tier.name %}">{{ tier.name }}</a></td>
                    <td>{{ tier.switch_count }}</td>
                    <td>{{ tier.ap_count }}</td>
                    <td>{{ tier.ups_count }}</td>
                    <td>{% widthratio tier.percent_down 1 100 %}%</td>
                    <td>{{ tier.last_event }}</td>
                    <td>{{ tier.trend }}</td>
                    <td>{{ tier.incident }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="card">
    <div class="card-body table-responsive p-0">
        <table class="table table-hover table-sm">
            <thead>
                <tr>
                    <th>Ack</th>
                    <th>Building</th>
                    <th>Switch Count</th>
                    <th>AP Count</th>
                    <th>UPS Count</th>
                    <th>Percent Down</th>
                    <th>Last Event</th>
                    <th>Trend</th>
                    <th>Incident Request</th>
                </tr>
            </thead>
            <tbody>
                {% for bldg in bldgs %}
                <tr>
                    <td>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="ack_bldg_{{ bldg.id }}">
                        </div>
                    </td>
                    <td><a href="{% url 'building' bldg.name %}">{{ bldg.name }}</a></td>
                    <td>{{ bldg.switch_count }}</td>
                    <td>{{ bldg.ap_count }}</td>
                    <td>{{ bldg.ups_count }}</td>
                    <td>{% widthratio bldg.percent_down 1 100 %}%</td>
                    <td>{{ bldg.last_event }}</td>
                    <td>{{ bldg.trend }}</td>
                    <td>{{ bldg.incident }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="card">
    <div class="card-body table-responsive p-0">
        <table class="table table-hover table-sm">
            <thead>
                <tr>
                    <th>Ack</th>
                    <th>Device</th>
                    <th>Trap</th>
                    <th>Recorded</th>
                    <th>Incident Request</th>
                    <th>Clear Trap</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="ack_bldg_{{ bldg.id }}">
                        </div>
                    </td>
                    <td>dummy row</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                {% for trap in traps %}
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<audio id="audiotag1" src="{% static 'akips/sound/mixkit-wrong-answer-fail-notification-946.wav' %}" preload="auto"></audio>
<a href="javascript:play_single_sound();">Play 5-sec sound on single channel</a>
<script type="text/javascript">
	function play_single_sound() {
		document.getElementById('audiotag1').play();
	}
</script>
{% endblock %}